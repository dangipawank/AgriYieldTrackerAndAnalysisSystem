<!DOCTYPE html>
<html>
  <head>
    <title>Crop Yield Tracker Dashboard</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, message in messages %}
    <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %} {% endif %} {% endwith %}

    <h1>Crop Yield Tracker</h1>
    <a href="{{ url_for('main.add_yield') }}">
      <button>Add New Yield</button>
    </a>

    <h2>Recent Yield Records</h2>
    <table border="1" cellpadding="5">
      <thead>
        <tr>
          {% for col in columns %}
          <th>{{ col }}</th>
          {% endfor %}
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for record in yield_records %}
        <tr>
          {% for col in columns %}
          <td>{{ record[col] }}</td>
          {% endfor %}
          <td>
            <a
              href="{{ url_for('main.edit_yield', yield_id=record['yieldid']) }}"
              >Edit</a
            >
            |
            <form
              method="POST"
              action="{{ url_for('main.delete_yield', yield_id=record['yieldid']) }}"
              style="display: inline"
              onsubmit="return confirm('Are you sure you want to delete this record?');"
            >
              <button type="submit">Delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="dashboard-metrics">
      <p><strong>Total Records:</strong> {{ total_records }}</p>
      <p>
        <strong>Total Area Harvested (ha):</strong> {{ '%.2f'|format(total_area)
        }}
      </p>
      <p>
        <strong>Total Production (tons):</strong> {{
        '%.2f'|format(total_production) }}
      </p>
      <p>
        <strong>Average Yield per ha:</strong> {{
        '%.2f'|format(avg_yield_per_ha) }}
      </p>
    </div>
  </body>
</html>
